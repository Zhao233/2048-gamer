<html>
    <head>
        <script src="http://code.jquery.com/jquery.js"></script>
    
        <script>
            function merge(array){
                var nodes = array;

                // for(var row = 0; row < nodes.length ; row++){//以行为单位,从上到下
                //     for(var column = nodes[0].length-1; column >= 0 ; column--){//以列为单位，从右往左
                //         console.log("row:" + row + ", column:" + column);

                //         if(nodes[row][column] != undefined && nodes[row][column] != 0){
                        
                //             var temp = nodes[row][column];
                        
                //             for(var index = ( column - 1 ); index >=0 ; index-- ){
                //                 if(nodes[row][index] == undefined || nodes[row][index] == 0){//是空节点的话就跳过
                //                     continue;
                //                 }
                            
                //                 if( nodes[row][index] == temp ){ //当两个节点的值相等时，把下面的值合并上去，并清除下面的值
                //                     nodes[row][index] = parseInt( nodes[row][index] ) * 2;
                                
                //                     nodes[row][column] = undefined;

                //                     column = index;//遍历下一个元素（合并后的下一个元素）
                //                 }

                //                 break;
                //             }
                //         }
                //     }

                //     var index_zero = nodes[0].length-1;

                //     for(var index_check = 0; index_check < nodes[0].length-1; index_check++){//将空位向最右移动

                //         if(nodes[row][index_check] == 0 || nodes[row][index_check]==undefined){
                //             for(var index_check_exchange = index_check; index_check_exchange < index_zero; index_check_exchange++){
                //                 var temp = nodes[row][index_check_exchange];

                //                 nodes[row][index_check_exchange] = nodes[row][index_check_exchange+1];
                //                 nodes[row][index_check_exchange+1] = temp;
                //             }

                //             index_zero--;
                //         }
                //     }
                // }

                for(var column = 0; column < nodes[0].length ; column++){//以列为单位,从左到右
                    for(var row = 0; row <nodes.length ; row++){//以行为单位，从上到下
                        console.log("row:" + row + ", column:" + column);

                        if(nodes[row][column] != undefined && nodes[row][column] != 0){
                        
                            var temp = nodes[row][column];
                        
                            for(var index = (row+1); index < nodes.length; index++ ){
                                if(nodes[index][column] == undefined || nodes[index][column] == 0){//是空节点的话就跳过
                                    continue;
                                }
                            
                                if( nodes[index][column] == temp ){ //当两个节点的值相等时，把下面的值合并上去，并清除下面的值
                                    nodes[index][column] = parseInt( nodes[index][column] ) * 2;
                                
                                    nodes[row][column] = undefined;

                                    row = index;//遍历下一个元素（合并后的下一个元素）
                                }

                                break;
                            }
                        }
                    }

                    /*将空格从下到上移动*/
                    var index_check = nodes.length-1;//开始的位置
                    var index_nonzero = 0;//已经存放空位的位置
                        
                    while(index_check >= index_nonzero){
                        if(nodes[index_check][column] == 0 || nodes[index_check][column] == undefined){
                            for(var i = index_check; i > 0 ; i--){
                                var temp = nodes[i][column];
                            
                                nodes[i][column] = nodes[i-1][column];
                                nodes[i-1][column] = temp;
                            }
                        
                            index_nonzero++;
                        }
                    
                        if(nodes[index_check][column] != 0 && nodes[index_check][column] != undefined){
                            index_check--;
                        }
                    }
                }
            
                console.log("矩阵： ")

                for(var i = 0; i < nodes.length; i++ ){
                    console.log(nodes[i][0]+" "+nodes[i][1]+" "+nodes[i][2]+" "+nodes[i][3])
                }
            }


            $(document).ready(function(){
                var arrays = [  [1,2,3,3],
                                [1,2,0,1],
                                [1,0,3,3],
                                [1,1,2,1]
                             ];

                merge(arrays);
            });
        </script>
    </head>
</html>